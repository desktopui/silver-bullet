<!DOCTYPE html>
<html lang="en-us">
  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <!-- Enable responsiveness on mobile devices-->
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1"
  />

  <title>
     Electron &middot; Silver Bullet 
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css" />
  <link rel="stylesheet" href="/public/css/syntax.css" />
  <link rel="stylesheet" href="/public/css/hyde.css" />
  <link
    rel="stylesheet"
    href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"
  />

  <!-- Icons -->
  <link
    rel="apple-touch-icon-precomposed"
    sizes="144x144"
    href="/public/apple-touch-icon-144-precomposed.png"
  />
  <link rel="shortcut icon" href="/public/favicon.ico" />

  <!-- RSS -->
  <link
    rel="alternate"
    type="application/rss+xml"
    title="RSS"
    href="//atom.xml"
  />
</head>


  <body class="flexbody">
    <div class="sidebar">
  <div class="container">
    <div class="sidebar-about">
      <h1>
        <a href="/"> Silver Bullet </a>
      </h1>
      <p class="lead">Implementing a chat app in different Desktop GUI frameworks</p>
    </div>

    <nav class="sidebar-nav">
      <a
        class="sidebar-nav-item"
        href="/"
        >Intro</a
      >

              
      <a
        class="sidebar-nav-item"
        href="/about/"
        >About</a
      >
            
      <a
        class="sidebar-nav-item active"
        href="/electron/"
        >Electron</a
      >
          
      <a
        class="sidebar-nav-item"
        href="/imgui/"
        >IMGUI</a
      >
          
      <a
        class="sidebar-nav-item"
        href="/"
        >Intro</a
      >
          
      <a
        class="sidebar-nav-item"
        href="/nuklear/"
        >Nuklear</a
      >
          
      <a
        class="sidebar-nav-item"
        href="/react-native-desktop/"
        >React Native Desktop</a
      >
          

      <a
        class="sidebar-nav-item"
        href="/archive/v2.1.0.zip"
        >Download</a
      >

      <a
        class="sidebar-nav-item"
        href="/archive/v2.1.0.zip"
        >Download</a
      >

      <a
        class="sidebar-nav-item"
        href="/archive/v2.1.0.zip"
        >Download</a
      >

      <a
        class="sidebar-nav-item"
        href="/archive/v2.1.0.zip"
        >Download</a
      >
      <a
        class="sidebar-nav-item"
        href="/archive/v2.1.0.zip"
        >Download</a
      >
      <a
        class="sidebar-nav-item"
        href="/archive/v2.1.0.zip"
        >Download</a
      >
      <a
        class="sidebar-nav-item"
        href="/archive/v2.1.0.zip"
        >Download</a
      >
      <a
        class="sidebar-nav-item"
        href="/archive/v2.1.0.zip"
        >Download</a
      >
      <a
        class="sidebar-nav-item"
        href="/archive/v2.1.0.zip"
        >Download</a
      >

      <a class="sidebar-nav-item" href="">GitHub</a>
    </nav>
  </div>
</div>


    <div class="content container"><div class="page">
  <h1 class="page-title">Electron</h1>
  <p><a href="https://electronjs.org">https://electronjs.org</a>
| <strong>Platforms</strong> | Linux, macOS, Windows |
| <strong>Renderer</strong> | Skia + WebGL |</p>

<p>Setup used for building a showcase app:</p>

<table>
  <tbody>
    <tr>
      <td><strong>Build system</strong></td>
      <td>Webpack</td>
    </tr>
    <tr>
      <td><strong>Languages</strong></td>
      <td>TypeScript</td>
    </tr>
    <tr>
      <td><strong>Libraries</strong></td>
      <td>React, styled components</td>
    </tr>
    <tr>
      <td><strong>Editor</strong></td>
      <td>Visual Studio Code</td>
    </tr>
  </tbody>
</table>

<ul>
  <li><a href="#internals">Internals</a></li>
  <li><a href="#network">Network</a></li>
  <li><a href="#os-integration">OS Integration</a></li>
  <li><a href="#developer-experience">Developer experience</a></li>
  <li><a href="#accessiblity">Accessiblity</a></li>
  <li><a href="#animations">Animations</a></li>
</ul>

<h2 id="internals">Internals</h2>

<p>Since Electron is based on a web browser, Chromium in this case, the developer experience for anyone who is already familiar with the web is just amazing.
For everything that is related to the UI inside a window you feel like you just write a web application. You have all sort of hot reloadings, DevTools that allows you to change styles on the fly and profile on every machine your app installed, and infinite amount of integrations with design tools.</p>

<p>The browser is an incredibly complicated piece of software, comparable with the Operating System itself. There is a lot happening to render these simple HTML + CSS into a pixels that we see on the screen. <em>I should put here a link to Chrome internals</em>. Chromium uses cross-platform library <strong>Skia</strong> (skia.org) to paint it.</p>

<p>Let’s check a simple button. In order to place an input on the screen you need HTML:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span><span class="nt">&gt;</span>Save<span class="nt">&lt;/button&gt;</span>
</code></pre></div></div>

<p>some optional CSS to style:</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">button</span> <span class="p">{</span>
  <span class="nl">margin</span><span class="p">:</span> <span class="m">2em</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>and optionally add JavaScript to handle changes:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">"input"</span><span class="p">).</span><span class="nx">onchange</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
</code></pre></div></div>

<p>This is the result you get on macOS:</p>

<p><img width="70" alt="screenshot 2019-01-13 14 00 03" src="https://user-images.githubusercontent.com/1004115/51084515-2e133c80-173c-11e9-869e-7f030a4e1a7a.png" /></p>

<p>How does it translate to different platforms? At first glance it looks like a native button on macOS, but when we press it, we can spot a little difference:</p>

<p><img src="https://user-images.githubusercontent.com/1004115/51084508-0e7c1400-173c-11e9-8e01-afae48d71047.gif" alt="a pressed button in Chrome" /></p>

<p><img src="https://user-images.githubusercontent.com/1004115/51084915-070c3900-1743-11e9-9040-87c1fa4395db.gif" alt="a pressed button in Safari" /></p>

<p>Why is it happening? If we dump our rendered chat client from HTML+CSS to Skia’s internal representation format and use a debugger, we can watch a step-by-step demonstration of how the whole document was painted by using lower-level graphical instructions:</p>

<p><img width="350" alt="Skia debugger step-by-step painting process of a chat" src="https://user-images.githubusercontent.com/1004115/51084323-92cc9800-1738-11e9-94fe-d40e56f16830.gif" /></p>

<p>And the button here is just an image of button’s background + set of glyphs drawn over it + some transformation logic.</p>

<p>So the button in Chrome doesn’t match native look and feel for every operating system out there. But who cares? In terms of styling, usually for a web site it does not mean a lot, controls are rarely used as it is, their design are customized and it probably won’t look anything like a default native button anyway:</p>

<p><img width="90" alt="A styled button" src="https://user-images.githubusercontent.com/1004115/51088353-9fb8ae00-176f-11e9-9a58-c4c891f6c6a2.png" /></p>

<p>For a certain group of desktop apps, though, you may want to “mimic” its look to make it closer to system controls. That is possible by carefully crafting the right CSS, but it’ll be harder to maintain over the time. As an example, look at the library that provided a set of macOS UI controls https://screenisland.com/maverix/#/controls, it became outdated the next second Apple released the next macOS version.</p>

<p>Good news, we don’t need anything like that for our chat app, and probably for any UI-heavy app.</p>

<h2 id="network">Network</h2>

<p>What about writing a network code, HTTP and WebSocket in particular? We can guess just by looking at the names of these protocols, we have Hypertext and Web here, both invented for the web browser. Surprisingly, though, HTTP was much more suited initially for interlinked documents, not apps, so all we have is XmlHttpRequest and Fetch and abstractions over them. But it’s no longer true, and you have things like WebRTC now and can build Skype on top of it.</p>

<p>And again we’re writing web application, so to start using Slack’s API we’ll go to npm:</p>

<p><code class="highlighter-rouge">yarn add @slack/client</code></p>

<p>and use it like this for HTTP API:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">web</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebClient</span><span class="p">(</span><span class="nx">token</span><span class="p">);</span>
<span class="k">return</span> <span class="nx">web</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">list</span><span class="p">({}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">results</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">results</span><span class="p">.</span><span class="nx">members</span> <span class="k">as</span> <span class="nb">Array</span><span class="o">&lt;</span><span class="nx">SlackUser</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div></div>

<p>and also we can use WebSocket-based, real-time client, without even thinking about details:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">rtm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RTMClient</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
<span class="nx">rtm</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"message"</span><span class="p">,</span> <span class="nx">message</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// Log the message</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
    <span class="s2">`(channel:</span><span class="p">${</span><span class="nx">message</span><span class="p">.</span><span class="nx">channel</span><span class="p">}</span><span class="s2">) </span><span class="p">${</span><span class="nx">message</span><span class="p">.</span><span class="nx">user</span><span class="p">}</span><span class="s2"> says: </span><span class="p">${</span><span class="nx">message</span><span class="p">.</span><span class="nx">text</span><span class="p">}</span><span class="s2">`</span>
  <span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<p><em>Here comes a small rant about how hard to write a desktop client for Slack, even though it’s understandable from the business’ standpoint and I should have probably picked something open sourced. But thanks to the support, turns out it’s possible to use undocumented way to use their API. And again, I love web, so easy to debug on live.</em></p>

<p><img width="1202" alt="Paused debugger for Slack developer section in order to change a scope parameter" src="https://user-images.githubusercontent.com/1004115/51083733-c951e500-172f-11e9-93ea-c918f874e25e.png" /></p>

<h2 id="os-integration">OS Integration</h2>

<p>To be able to write an app</p>

<p><img width="1347" alt="oAuth in a Slack app that does not re-use the browser" src="https://user-images.githubusercontent.com/1004115/51083737-cfe05c80-172f-11e9-854a-96079c04d274.png" /></p>

<p>OAuth leveraging existing Slack session in browser.</p>

<h2 id="developer-experience">Developer experience</h2>

<p><img width="1041" alt="Simplicity of UI development in Electron — it's basically the same as in the browser" src="https://user-images.githubusercontent.com/1004115/51083744-ef778500-172f-11e9-9ed8-d7665c42757a.png" /></p>

<h2 id="accessiblity">Accessiblity</h2>

<p><img width="400" alt="macOS accessibility shortcuts" src="https://user-images.githubusercontent.com/1004115/51406915-8c408500-1b6b-11e9-9243-f6c2eab9bc1a.png" /></p>

<p><img src="" alt="macOS accessiblity quick links" /></p>

<ol>
  <li>Voice Over</li>
</ol>

<p>At first, after writing a prototype, I was getting “link, #webrender, we”:
<img width="400" alt="Voice over demonstration for menu, it says link, #webrender, we" src="https://user-images.githubusercontent.com/1004115/51429958-67104d00-1c25-11e9-9f08-410aa942c012.png" /></p>

<p>Why is that?</p>

<p>Because produced HTML looked like this:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span>
    <span class="nt">&lt;span&gt;</span>#<span class="nt">&lt;/span&gt;</span>

    <span class="nt">&lt;span&gt;</span>webrender<span class="nt">&lt;/span&gt;</span>

    <span class="nt">&lt;span&gt;</span>we<span class="nt">&lt;/span&gt;</span>
  <span class="nt">&lt;/a&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<p>After reading <a href="https://inclusive-components.design/menus-menu-buttons/">https://inclusive-components.design/menus-menu-buttons/</a>, I added some semantics and aria attributes:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;nav&gt;</span>
  <span class="nt">&lt;ul</span> <span class="na">aria-labelledby=</span><span class="s">"sections-heading"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h3</span> <span class="na">id=</span><span class="s">"sections-heading"</span><span class="nt">&gt;</span>Channel List<span class="nt">&lt;/h3&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
    <span class="nt">&lt;li&gt;</span>
      <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span> <span class="na">aria-current=</span><span class="s">"page"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">aria-hidden=</span><span class="s">"true"</span><span class="nt">&gt;</span>#<span class="nt">&lt;/span&gt;</span>

        <span class="nt">&lt;span</span> <span class="na">aria-label=</span><span class="s">"channel webrender"</span><span class="nt">&gt;</span>webrender<span class="nt">&lt;/span&gt;</span>

        <span class="nt">&lt;span</span> <span class="na">aria-hidden=</span><span class="s">"true"</span><span class="nt">&gt;</span>we<span class="nt">&lt;/span&gt;</span>
      <span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;/li&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
  <span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/nav&gt;</span>
</code></pre></div></div>

<p>It’s all done in Styled components and React fully supports <code class="highlighter-rouge">aria-</code> attributes.</p>

<p>So we hide <code class="highlighter-rouge">#</code> and <code class="highlighter-rouge">we</code> (needed for the compact mode), and now it looks like menu, and user knows what to expect:</p>

<p><img width="402" alt="The demonstration of Voice over after a small refactoring" src="https://user-images.githubusercontent.com/1004115/51430179-4f869380-1c28-11e9-9276-6b9e889f4ec7.png" /></p>

<p>And what’s nice, we can use LightHouse to inspect accessiblity since our UI is basically a html opened in web browser.</p>

<h2 id="animations">Animations</h2>

<p>To be continued…</p>

</div>
</div>
  </body>
</html>
